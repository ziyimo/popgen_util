psmc_file = '../psmc_data/psmc_out/CEU_NA11893_04-12_0747.psmc'
X<-scan(file=psmc_file,what="",sep="\n",quiet=TRUE)
START<-grep("^RD",X)
END<-grep("^//",X)
X<-X[START[it+1]:END[it+1]]
it=30
X<-X[START[it+1]:END[it+1]]
X
TR<-grep("^TR",X,value=TRUE)
RS<-grep("^RS",X,value=TRUE)
write(TR,"temp.psmc.result")
theta0<-as.numeric(read.table("temp.psmc.result")[1,2])
N0<-theta0/4/mu/s
mu=2.5e-8
s=100
N0<-theta0/4/mu/s
write(RS,"temp.psmc.result")
a<-read.table("temp.psmc.result")
View(a)
View(a)
Generation<-as.numeric(2*N0*a[,3])
Ne<-as.numeric(N0*a[,4])
file.remove("temp.psmc.result")
n.points<-length(Ne)
Generation[-n.points]
?as.numeric
YearsAgo<-c(as.numeric(rbind(Generation[-n.points],Generation[-1])),
Generation[n.points])*g
YearsAgo<-c(as.numeric(rbind(Generation[-n.points],Generation[-1])),
Generation[n.points])#*g
Ne<-c(as.numeric(rbind(Ne[-n.points],Ne[-n.points])),
Ne[n.points])
Generation[-1]
Generation[n.points]
as.numeric(rbind(Generation[-n.points],Generation[-1]))
get_Ne_by_gen<-function(psmc_file,it=30,mu=2.5e-8,s=100){
X<-scan(file=psmc_file,what="",sep="\n",quiet=TRUE)
START<-grep("^RD",X)
END<-grep("^//",X)
X<-X[START[it+1]:END[it+1]]
TR<-grep("^TR",X,value=TRUE)
RS<-grep("^RS",X,value=TRUE)
write(TR,"temp.psmc.result")
theta0<-as.numeric(read.table("temp.psmc.result")[1,2])
N0<-theta0/4/mu/s
write(RS,"temp.psmc.result")
a<-read.table("temp.psmc.result")
Generation<-as.numeric(2*N0*a[,3])
Ne<-as.numeric(N0*a[,4])
file.remove("temp.psmc.result")
data.frame(Generation,Ne)
}
test = get_Ne_by_gen("../psmc_data/psmc_out/CEU_NA11893_04-12_0747.psmc")
View(test)
?round
get_Ne_by_gen<-function(psmc_file,it=30,mu=2.5e-8,s=100){
X<-scan(file=psmc_file,what="",sep="\n",quiet=TRUE)
START<-grep("^RD",X)
END<-grep("^//",X)
X<-X[START[it+1]:END[it+1]]
TR<-grep("^TR",X,value=TRUE)
RS<-grep("^RS",X,value=TRUE)
write(TR,"temp.psmc.result")
theta0<-as.numeric(read.table("temp.psmc.result")[1,2])
N0<-theta0/4/mu/s
write(RS,"temp.psmc.result")
a<-read.table("temp.psmc.result")
Generation<-as.numeric(2*N0*a[,3])
Ne<-as.numeric(N0*a[,4])
file.remove("temp.psmc.result")
data.frame(round(Generation),round(Ne))
}
test = get_Ne_by_gen("../psmc_data/psmc_out/CEU_NA11893_04-12_0747.psmc")
View(test)
file = '../psmc_data/psmc_out/CEU_NA11893_04-12_0747.psmc'
X<-scan(file=file,what="",sep="\n",quiet=TRUE)
START<-grep("^RD",X)
END<-grep("^//",X)
i.iteration=30
X<-X[START[i.iteration+1]:END[i.iteration+1]]
TR<-grep("^TR",X,value=TRUE)
RS<-grep("^RS",X,value=TRUE)
write(TR,"temp.psmc.result")
theta0<-as.numeric(read.table("temp.psmc.result")[1,2])
mu=2.5e-8
s=100
N0<-theta0/4/mu/s
write(RS,"temp.psmc.result")
a<-read.table("temp.psmc.result")
Generation<-as.numeric(2*N0*a[,3])
Ne<-as.numeric(N0*a[,4])
file.remove("temp.psmc.result")
View(a)
YearsAgo<-c(as.numeric(rbind(Generation[-n.points],Generation[-1])),
Generation[n.points])#*g
n.points<-length(Ne)
YearsAgo<-c(as.numeric(rbind(Generation[-n.points],Generation[-1])),
Generation[n.points])#*g
YearsAgo
Generation
Ne<-c(as.numeric(rbind(Ne[-n.points],Ne[-n.points])),
Ne[n.points])
Ne<-as.numeric(N0*a[,4])
Ne_p<-c(as.numeric(rbind(Ne[-n.points],Ne[-n.points])),
Ne[n.points])
Ne
Ne_p
data.frame(YearsAgo,Ne)
file='../psmc_data/psmc_out/CEU_NA11893_04-12_0747.psmc'
i.iteration=30
mu=2.5e-8
s=100
X<-scan(file=file,what="",sep="\n",quiet=TRUE)
START<-grep("^RD",X)
END<-grep("^//",X)
X<-X[START[i.iteration+1]:END[i.iteration+1]]
TR<-grep("^TR",X,value=TRUE)
RS<-grep("^RS",X,value=TRUE)
write(TR,"temp.psmc.result")
theta0<-as.numeric(read.table("temp.psmc.result")[1,2])
N0<-theta0/4/mu/s
write(RS,"temp.psmc.result")
a<-read.table("temp.psmc.result")
Generation<-as.numeric(2*N0*a[,3])
Ne<-as.numeric(N0*a[,4])
file.remove("temp.psmc.result")
n.points<-length(Ne)
YearsAgo<-c(as.numeric(rbind(Generation[-n.points],Generation[-1])),
Generation[n.points])#*g
Ne<-c(as.numeric(rbind(Ne[-n.points],Ne[-n.points])),
Ne[n.points])
gen_N_df_1 = data.frame(YearsAgo,Ne)
View(gen_N_df_1)
psmc_file = file
it = i.iteration
X<-scan(file=psmc_file,what="",sep="\n",quiet=TRUE)
START<-grep("^RD",X)
END<-grep("^//",X)
X<-X[START[it+1]:END[it+1]]
TR<-grep("^TR",X,value=TRUE)
RS<-grep("^RS",X,value=TRUE)
write(TR,"temp.psmc.result")
theta0<-as.numeric(read.table("temp.psmc.result")[1,2])
N0<-theta0/4/mu/s
write(RS,"temp.psmc.result")
a<-read.table("temp.psmc.result")
Generation<-as.numeric(2*N0*a[,3])
Ne<-as.numeric(N0*a[,4])
file.remove("temp.psmc.result")
gen_N_df_2 = data.frame(round(Generation),round(Ne))
View(gen_N_df_2)
?aggregate
?lead
library(dplyr)
install.packages("dplyr")
library(dplyr)
?lead
lead(1:10, 1)
?filter
lag(gen_N_df_2$round.Ne.)
gen_N_df_2$round.Ne. != lag(gen_N_df_2$round.Ne.)
gen_N_df_2$round.Ne. != lag(gen_N_df_2$round.Ne.) | is.na(lag(gen_N_df_2$round.Ne.))
max(gen_N_df_2$round.Generation.)-gen_N_df_2$round.Generation.
Generation
Generation<-round(as.numeric(2*N0*a[,3]))
Ne<-round(as.numeric(N0*a[,4]))
Generation
Ne
no_Gen <- max(Generation)
no_Gen - Generation
Generation[Ne!=lag(Ne)]
Ne[Ne!=lead(Ne)]
?rev
goi <- rev(Generation[Ne!=lag(Ne)])
dNe <- rev(Ne[Ne!=lead(Ne)])
gen_Ne <- cbind(goi, dNe)
View(gen_Ne)
goi <- no_Gen - rev(Generation[Ne!=lag(Ne)])
dNe <- rev(Ne[Ne!=lead(Ne)])
gen_Ne <- cbind(goi, dNe)
Generation[-2]
Generation
Generation[-1][-length(Generation)]
Generation[-length(Generation)][-1]
goi <- rev(Generation[Ne!=lag(Ne)])[-length(goi)][-1]
goi <- max(goi) - goi
dNe <- rev(Ne[Ne!=lead(Ne)])[-length(dNe)][-1]
gen_Ne <- cbind(goi, dNe)
goi
goi <- rev(Generation[Ne!=lag(Ne)])[-length(goi)][-1]
goi
Generation[Ne!=lag(Ne)]
Ne[Ne!=lead(Ne)]
goi <- rev(Generation[Ne!=lag(Ne)][-1])
#goi <- max(goi) - goi
dNe <- rev(Ne[Ne!=lead(Ne)])[-1]
gen_Ne <- cbind(goi, dNe)
goi <- rev(Generation[Ne!=lag(Ne)][-1])
goi <- max(goi) - goi
dNe <- rev(Ne[Ne!=lead(Ne)])[-1]
gen_Ne <- cbind(goi, dNe)
?commandArgs
?return
rbind(c(mu, r), gen_Ne)
t_r <- as.double(unlist(strsplit(TR, '\t'))[2:3])
#write(TR,"temp.psmc.result")
#theta0<-as.numeric(read.table("temp.psmc.result")[1,2])
N0<-t_r[1]/4/mu/s
r = t_r[2]/(4*N_0)
r = t_r[2]/(4*N0)
write(RS,"temp.psmc.result")
a<-read.table("temp.psmc.result")
Generation<-round(as.numeric(2*N0*a[,3]))
Ne<-round(as.numeric(N0*a[,4]))
file.remove("temp.psmc.result")
goi <- rev(Generation[Ne!=lag(Ne)][-1])
goi <- max(goi) - goi
dNe <- rev(Ne[Ne!=lead(Ne)])[-1]
gen_Ne <- cbind(goi, dNe)
rbind(c(mu, r), gen_Ne)
?as.character
as.character(gen_Ne)
test <- as.character(gen_Ne)
list(c(mu, r), gen_Ne)
?write.table()
get_Ne_by_gen<-function(psmc_file,it=30,mu=2.5e-8,s=100){
X<-scan(file=psmc_file,what="",sep="\n",quiet=TRUE)
START<-grep("^RD",X)
END<-grep("^//",X)
X<-X[START[it+1]:END[it+1]]
TR<-grep("^TR",X,value=TRUE)
RS<-grep("^RS",X,value=TRUE)
t_r <- as.double(unlist(strsplit(TR, '\t'))[2:3])
#write(TR,"temp.psmc.result")
#theta0<-as.numeric(read.table("temp.psmc.result")[1,2])
N0<-t_r[1]/4/mu/s
r = t_r[2]/(4*N0)
write(RS,"temp.psmc.result")
a<-read.table("temp.psmc.result")
Generation<-round(as.numeric(2*N0*a[,3]))
Ne<-round(as.numeric(N0*a[,4]))
file.remove("temp.psmc.result")
goi <- rev(Generation[Ne!=lag(Ne)][-1])
goi <- max(goi) - goi
dNe <- rev(Ne[Ne!=lead(Ne)])[-1]
gen_Ne <- cbind(goi, dNe)
#data.frame(round(Generation),round(Ne))
return(list(c(mu, r), gen_Ne))
}
params = get_Ne_by_gen("../psmc_data/psmc_out/CEU_NA11893_04-12_0747.psmc")
View(params)
?commandArgs
?write.table
